---
import { getTranslations } from '~/i18n/utils'

const lang = Astro.currentLocale || 'fr'
const t = getTranslations(lang as 'fr' | 'en')

const heroVideoSrc = '/videos/tulum_property_hero.mp4'
const heroImageFallback = '/images/hero-bg.jpg'
---

<section id="home" class="relative min-h-screen flex items-center justify-center overflow-hidden">
  <!-- Background Video/Image with natural fallback -->
  <div class="absolute inset-0 z-0">
    <!-- Natural gradient background as fallback (forest/rural colors) -->
    <div class="absolute inset-0 bg-gradient-to-br from-[#2d5016] via-[#3a6030] to-[#1a3320]"></div>
    
    <!-- Video Background (inspired by Our Habitas) -->
    <video
      id="hero-video"
      class="absolute inset-0 w-full h-full object-cover"
      autoplay
      muted
      loop
      playsinline
      preload="auto"
      poster={heroImageFallback}
    >
      <source src={heroVideoSrc} type="video/mp4" />
    </video>
    
    <!-- Image fallback (shown if video doesn't load) -->
    <div 
      id="hero-image-fallback"
      class="absolute inset-0 bg-cover bg-center hidden" 
      style="background-image: url('{heroImageFallback}'); background-position: center; background-size: cover;"
    ></div>
    
    <!-- Gradient overlay for text readability (inspired by Our Habitas) -->
    <div class="absolute inset-0 bg-gradient-to-b from-black/40 via-black/30 to-black/50"></div>
    <!-- Additional natural overlay -->
    <div class="absolute inset-0 bg-[#2d5016]/10"></div>
  </div>

  <!-- Content - Inspired by Our Habitas hero layout -->
  <div class="relative z-20 text-center px-10 sm:px-16 lg:px-24 max-w-5xl mx-auto opacity-0 translate-y-8 animate-fade-in-up" style="animation-delay: 0.2s;">
    <!-- Location tag (like Our Habitas) -->
    <p class="text-sm md:text-base font-light tracking-[0.3em] text-white/90 mb-8 uppercase animate-slide-down">
      Aveyron, France
    </p>
    
    <!-- Main title -->
    <h1 class="text-6xl md:text-8xl lg:text-9xl font-extralight tracking-tight text-white mb-8 leading-[0.9] drop-shadow-lg">
      {t.hero.title}
    </h1>
    
    <!-- Subtitle -->
    <p class="text-xl md:text-2xl lg:text-3xl font-light text-white/95 mb-8 tracking-wide max-w-3xl mx-auto drop-shadow-md">
      {t.hero.subtitle}
    </p>
    
    <!-- Description -->
    <div class="w-24 h-[1px] bg-white/60 mx-auto mb-8"></div>
    <p class="text-lg md:text-xl text-white/90 mb-12 max-w-2xl mx-auto font-light leading-relaxed drop-shadow-sm">
      {t.hero.description}
    </p>
    
    <!-- CTA Buttons - Minimal elegant style -->
    <div class="flex flex-col sm:flex-row gap-6 justify-center items-center">
      <a 
        href="#experience" 
        class="px-12 py-4 bg-white text-black font-light tracking-[0.2em] hover:bg-neutral-200 transition-all duration-500 uppercase text-xs min-w-[200px] text-center"
      >
        {t.hero.cta.explore}
      </a>
      <a 
        href="#contact" 
        class="px-12 py-4 border border-white text-white font-light tracking-[0.2em] hover:bg-white hover:text-black transition-all duration-500 uppercase text-xs min-w-[200px] text-center backdrop-blur-sm"
      >
        {t.hero.cta.contact}
      </a>
    </div>
  </div>

  <!-- Scroll Indicator -->
  <div class="absolute bottom-12 left-1/2 transform -translate-x-1/2 z-20 flex flex-col items-center gap-2 opacity-70 animate-bounce duration-[2000ms]">
    <span class="text-[10px] tracking-[0.2em] uppercase text-white font-light">Scroll</span>
    <div class="w-[1px] h-12 bg-gradient-to-b from-white to-transparent"></div>
  </div>
</section>

<script>
  // Handle video loading errors - fallback to image
  const heroVideo = document.getElementById('hero-video')
  const heroImageFallback = document.getElementById('hero-image-fallback')
  
  if (heroVideo) {
    heroVideo.addEventListener('error', () => {
      // Video failed to load, show image fallback
      if (heroImageFallback) {
        heroVideo.style.display = 'none'
        heroImageFallback.classList.remove('hidden')
      }
    })
    
    heroVideo.addEventListener('loadeddata', () => {
      // Video loaded successfully
      if (heroImageFallback) {
        heroImageFallback.classList.add('hidden')
      }
    })
    
    // Try to play the video (required for autoplay in some browsers)
    heroVideo.play().catch(() => {
      // Autoplay failed, show image fallback
      if (heroImageFallback) {
        heroVideo.style.display = 'none'
        heroImageFallback.classList.remove('hidden')
      }
    })
  }
</script>
